#!/bin/bash

# Check if the UFW firewall is enabled
if [ $(ufw status | grep -c "Status: active") -eq 1 ]; then
    echo "Firewall is enabled."
else
    echo "Firewall is disabled."
fi

# Check if the default policy is set to deny incoming traffic
if [ $(sudo ufw status | grep -c "Default: deny (incoming)") -eq 1 ]; then
    echo "Incoming traffic is blocked."
else
    echo "Incoming traffic is allowed."
fi

# Check which services are running and listening on which ports
echo "Services running and listening on ports:"
sudo netstat -tulpn | grep LISTEN | grep -v "127.0.0.1"

# Check authentication mechanisms
echo "Authentication mechanisms:"

# Check PAM authentication mechanisms
echo "PAM authentication mechanisms:"
sudo cat /etc/pam.d/common-auth | grep -v "^#"

# Check password complexity requirements
echo "Password complexity requirements:"
sudo cat /etc/pam.d/common-password | grep "pam_cracklib.so"

# Check SSH key authentication
echo "SSH key authentication:"
sudo cat /etc/ssh/sshd_config | grep -i "PubkeyAuthentication"
